pipeline {
    agent any
    environment {
        registry = "519852036875.dkr.ecr.us-east-2.amazonaws.com/my-node.js-app"
    }
    stages{
    stage("kubernetes deployment"){
		 stage("kubernetes deployment"){
              sh 'kubectl apply -f nodejsapp.yaml'
           }
        }
     }
       stages{
       stage ('K8S Deploy') {
       steps{
                kubernetesDeploy(
                    configs: 'nodejscjp/nodejsapp.yaml',
                    kubeconfigId: 'Kubernetes-Jenkins-Integration',
                    enableConfigSubstitution: true
                    )               
        }
     }
  }
}
